@(title: String, courts: List[Court], isLoggedIn: Boolean)
@import utils.Tags._

@scripts = {
    <link rel="stylesheet" href="@routes.Assets.at("stylesheets/courts.css")">
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=true&libraries=places"></script>
    @* <script src="@routes.Assets.at("javascripts/courts-map.js")" type="text/javascript"></script> *@

    <script type="text/javascript">

        //currently set to Univeristy of Hawaii at Manoa as deafult
        var uh = new google.maps.LatLng(21.2970, -157.8170);
        var hawaii = new google.maps.LatLng(21.4814, -157.9464)

        function initialize() {

            var mapOptions = {
                //center: new google.maps.LatLng(21.2970, -157.8170),
                center: hawaii,
                zoom: 10
            };

            var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

            setMarkers(map, courts);

            // Try HTML5 geolocation
            if(navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    var pos = new google.maps.LatLng(position.coords.latitude,
                    position.coords.longitude);

                    var infowindow = new google.maps.InfoWindow({
                        map: map,
                        position: pos,
                        content: 'You are here.'
                    });

                    map.setCenter(pos);
                    map.setZoom(13)
                }, function() {
                    handleNoGeolocation(true);
                });
            } else {
                // Browser doesn't support Geolocation
                handleNoGeolocation(false);
            }


        }

        var courts = [
            @for(court <- courts) {
                ['@court.getName', @court.getAddress.getLat, @court.getAddress.getLng, '@court.getDescription', @court.getId],
            }
        ]

        var infowindow =  new google.maps.InfoWindow();

        function setMarkers(map, locations) {
            for (var i = 0; i < locations.length; i++) {
                var court = courts[i];
                var myLatLng = new google.maps.LatLng (court[1], court[2]);
                var marker = new google.maps.Marker ({
                    position : myLatLng,
                    map : map,
                    title : court[0] 
                });
                var name = slugifyName(court[0]);
                var description = "<b>" + court[0] + "</b></br>" + court[3] + "</br><a href='" + "courts/" + court[4] + "/" + name + "'>more info</a>";

                bindInfoWindow(marker, map, infowindow, description);
            }
        }
        
        function slugifyName(name) {
        	return name.toLowerCase()
        	   .replace(/ /g, '-')
        	   .replace(/[^\w-]+/g, '');
        }

        function bindInfoWindow(marker, map, infowindow, strDescription) {
            google.maps.event.addListener(marker, 'click', function() {
                //infowindow.close();
                infowindow.setContent(strDescription);
                infowindow.open(map, marker);
            });
        }

        function handleNoGeolocation(errorFlag) {
            /*if (errorFlag) {
                var content = 'Error: The Geolocation service failed.';
            } else {
                var content = 'Error: Your browser doesn\'t support geolocation.';
            }

            var options = {
                map: map,
                position: uh,
                content: content
            };

            var infowindow = new google.maps.InfoWindow(options);*/
            map.setCenter(hawaii);
            map.setZoom(12);
        }


        google.maps.event.addDomListener(window, 'load', initialize);
    </script>
}

@Main(title, isLoggedIn: Boolean, scripts) {
    <div class="container">
    <!-- Sorting Dropdown
    <div class="row">
        <div class="col-sm-12">
            <div class="pull-right">
                Sort By
                <select id="order-ctrl" size="1">
                    <option value="alt">Alphabetical</option>
                    <option value="absdate">Ranking</option>
                    <option value="date">Most Recent</option>
                    <option value="r">Popularity</option>
                </select>
            </div>
        </div>
    </div> -->

    <!-- Gym Form
    <div class="row">
        <div class="col-sm-12">
            <a href="GymForm.html" class="btn-sm btn-primary pull-right active" role="button">Create Gym</a>
        </div>
    </div> -->

    <!-- Tab Navigation -->
    <ul class="nav nav-tabs" data-tabs="tabs">
        <li class="active"><a href="#map" data-toggle="tab">Map</a></li>
        <li><a href="#list" data-toggle="tab">List</a></li>

    </ul>

    <!-- Tab Content -->
    <div id="myTabContent" class="tab-content">

        <!-- Map -->
        <div id="map" class="tab-pane fade in active">
            <div class="row">
                <div class="col-md-12">
                    <div id="map-canvas"></div>
                </div>
            </div>
        </div>



        <!-- List -->
        <div id="list" class="tab-pane fade">
            <div class="hidden-xs">

                @for((court, index) <- courts.zipWithIndex){

                    @if(index % 3 == 0) {
                        <div class="row">
                    }

                        <div class="col-sm-4">
                            <div class="thumbnail">
                                <img src="http://www.to-hawaii.com/oahu/beaches/images/kuliououbeach/basketball_court.jpg" alt="...">
                                <div class="caption">
                                    <h3>@court.getName</h3>
                                    <p>@court.getDescription</p>
                                    <p>
                                        <a href="@routes.Courts.getCourt(court.getId, slugify(court.getName))" class="btn btn-primary" role="button">View</a>
                                        <a href="#" class="btn btn-default" role="button">Like</a>
                                    </p>
                                </div>
                            </div>
                        </div>

                    @if(index % 3 == 2 || index == courts.size()){
                        </div>
                    }
                }
            </div>

            <!-- List (phone)-->
            <div class="visible-xs col-xs-12">
                <div class="row">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Type</th>
                            </tr>
                        </thead>

                        <tbody data-link="row" class="rowlink">
                            @for(court <- courts) {
                                <tr>
                                    <td><a href="@routes.Courts.getCourt(court.getId, slugify(court.getName))">@court.getName</a></td>
                                    <td>@court.getType</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
    </div>
}
